// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model WebhookMessage {
  id        String   @id @default(cuid())
  type      String   // 通知类型，如 quota_exceed, balance_low 等
  title     String   // 通知标题
  content   String   // 通知内容（已处理占位符）
  values    String?  // JSON格式存储原始values数组
  timestamp BigInt   // 原始时间戳
  receivedAt DateTime @default(now()) // 服务器接收时间

  // 请求相关信息
  userAgent String?  // User-Agent头
  sourceIp  String?  // 来源IP
  signature String?  // webhook签名

  // 处理状态
  processed Boolean @default(false)

  @@map("webhook_messages")
  @@index([type])
  @@index([timestamp])
  @@index([receivedAt])
}

model Admin {
  id           String    @id @default(cuid())
  username     String    @unique
  passwordHash String
  createdAt    DateTime  @default(now())
  lastLoginAt  DateTime?
  isActive     Boolean   @default(true)

  @@map("admins")
  @@index([username])
}
